# API для управления задачами (To-Do List API)

Это REST API для управления списком задач, разработанное на Laravel 11 с использованием современных практик разработки.

## Возможности

-   Создание, просмотр, обновление и удаление задач
-   Валидация данных с кастомными сообщениями на русском языке
-   Обработка ошибок с понятными ответами
-   Использование FormRequest для валидации
-   API Resources для форматирования ответов
-   Типизация с использованием возможностей PHP 8+

## Структура задачи

```json
{
    "id": 1,
    "title": "Название задачи",
    "description": "Описание задачи",
    "status": "pending|in_progress|completed",
    "created_at": "2025-08-27 07:47:12",
    "updated_at": "2025-08-27 07:47:12"
}
```

## API Endpoints

### 1. Получить все задачи

**GET** `/api/tasks`

**Ответ:**

```json
{
    "data": [
        {
            "id": 1,
            "title": "Моя задача",
            "description": "Описание задачи",
            "status": "pending",
            "created_at": "2025-08-27 07:47:12",
            "updated_at": "2025-08-27 07:47:12"
        }
    ]
}
```

### 2. Получить одну задачу

**GET** `/api/tasks/{id}`

**Ответ:**

```json
{
    "data": {
        "id": 1,
        "title": "Моя задача",
        "description": "Описание задачи",
        "status": "pending",
        "created_at": "2025-08-27 07:47:12",
        "updated_at": "2025-08-27 07:47:12"
    }
}
```

### 3. Создать новую задачу

**POST** `/api/tasks`

**Заголовки:**

```
Content-Type: application/json
Accept: application/json
```

**Тело запроса:**

```json
{
    "title": "Название задачи",
    "description": "Описание задачи (необязательно)",
    "status": "pending (необязательно, по умолчанию pending)"
}
```

**Пример успешного ответа:**

```json
{
    "data": {
        "id": 1,
        "title": "Название задачи",
        "description": "Описание задачи",
        "status": "pending",
        "created_at": "2025-08-27 07:47:12",
        "updated_at": "2025-08-27 07:47:12"
    }
}
```

### 4. Обновить задачу

**PUT** `/api/tasks/{id}`

**Заголовки:**

```
Content-Type: application/json
Accept: application/json
```

**Тело запроса:**

```json
{
    "title": "Обновленное название",
    "description": "Обновленное описание",
    "status": "in_progress"
}
```

**Ответ:**

```json
{
    "data": {
        "id": 1,
        "title": "Обновленное название",
        "description": "Обновленное описание",
        "status": "in_progress",
        "created_at": "2025-08-27 07:47:12",
        "updated_at": "2025-08-27 07:47:34"
    }
}
```

### 5. Удалить задачу

**DELETE** `/api/tasks/{id}`

**Ответ:**

```json
{
    "message": "Задача успешно удалена"
}
```

## Валидация

### Правила валидации для создания задачи:

-   `title`: обязательное поле, строка, максимум 255 символов
-   `description`: необязательное поле, строка, максимум 1000 символов
-   `status`: необязательное поле, одно из значений: `pending`, `in_progress`, `completed`

### Правила валидации для обновления задачи:

-   `title`: необязательное поле (если передается, то обязательное), строка, максимум 255 символов
-   `description`: необязательное поле, строка, максимум 1000 символов
-   `status`: необязательное поле, одно из значений: `pending`, `in_progress`, `completed`

### Пример ошибки валидации:

```json
{
    "message": "Ошибка валидации данных",
    "errors": {
        "title": ["Название задачи обязательно для заполнения."]
    }
}
```

## Обработка ошибок

### 404 - Ресурс не найден

```json
{
    "message": "Ресурс не найден",
    "error": "Запрашиваемый объект не существует"
}
```

### 422 - Ошибка валидации

```json
{
    "message": "Ошибка валидации данных",
    "errors": {
        "title": ["Название задачи обязательно для заполнения."]
    }
}
```

### 500 - Внутренняя ошибка сервера (в продакшене)

```json
{
    "message": "Внутренняя ошибка сервера",
    "error": "Что-то пошло не так"
}
```

## Примеры использования с curl

### Создать задачу:

```bash
curl -X POST http://127.0.0.1:8000/api/tasks \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{"title":"Моя новая задача","description":"Описание задачи","status":"pending"}'
```

### Получить все задачи:

```bash
curl -X GET http://127.0.0.1:8000/api/tasks \
  -H "Accept: application/json"
```

### Получить задачу по ID:

```bash
curl -X GET http://127.0.0.1:8000/api/tasks/1 \
  -H "Accept: application/json"
```

### Обновить задачу:

```bash
curl -X PUT http://127.0.0.1:8000/api/tasks/1 \
  -H "Content-Type: application/json" \
  -H "Accept: application/json" \
  -d '{"title":"Обновленная задача","status":"completed"}'
```

### Удалить задачу:

```bash
curl -X DELETE http://127.0.0.1:8000/api/tasks/1 \
  -H "Accept: application/json"
```

## Архитектура проекта

Проект следует современным практикам Laravel разработки:

### Структура файлов:

-   `app/Models/Task.php` - Модель задачи с настройками массового заполнения
-   `app/Http/Controllers/Api/TaskController.php` - API контроллер с CRUD операциями
-   `app/Http/Requests/StoreTaskRequest.php` - FormRequest для валидации создания задачи
-   `app/Http/Requests/UpdateTaskRequest.php` - FormRequest для валидации обновления задачи
-   `app/Http/Resources/TaskResource.php` - API Resource для форматирования ответов
-   `database/migrations/*_create_tasks_table.php` - Миграция для создания таблицы задач
-   `routes/api.php` - API маршруты
-   `bootstrap/app.php` - Настройка обработки исключений

### Особенности реализации:

1. **FormRequest классы** для валидации с кастомными сообщениями на русском языке
2. **API Resources** для единообразного форматирования ответов
3. **Model binding** в контроллере для автоматического поиска моделей
4. **Типизация** с использованием возможностей PHP 8+
5. **Глобальная обработка исключений** для API endpoints
6. **Единообразная структура ответов** для всех endpoints

### Используемые статус-коды:

-   `200` - Успешный запрос
-   `201` - Ресурс создан (автоматически для POST запросов)
-   `404` - Ресурс не найден
-   `422` - Ошибка валидации
-   `500` - Внутренняя ошибка сервера

## Запуск проекта

1. Установите зависимости: `composer install`
2. Выполните миграции: `php artisan migrate`
3. Запустите сервер: `php artisan serve`
4. API будет доступно по адресу: `http://127.0.0.1:8000/api/tasks`
